<!DOCTYPE html>
<title>Sudoku Solver</title>
<!--2.Jquery-->
<script type="text/javascript" src="DataTables/jquery-3.6.0.min.js"></script>

<!--4.Excel import(exceljsonlength for file size?)-->
<script>
class Cell{constructor(e,s){this.number=-1,this.possibleNumbers=[1,2,3,4,5,6,7,8,9],this.x=e,this.y=s,this.box=Math.floor(e/3)+3*Math.floor(s/3)}basicLogic(e){for(var s=0;s<9;s++){var i=e[this.x+9*s].number;if(-1==this.number){if(-1!=i)-1!=(t=this.possibleNumbers.indexOf(i))&&this.possibleNumbers.splice(t,1)}else if(-1==i)-1!=(t=e[this.x+9*s].possibleNumbers.indexOf(this.number))&&e[this.x+9*s].possibleNumbers.splice(t,1)}for(var r=0;r<9;r++){i=e[r+9*this.y].number;if(-1==this.number){if(-1!=i)-1!=(t=this.possibleNumbers.indexOf(i))&&this.possibleNumbers.splice(t,1)}else if(-1==i)-1!=(t=e[r+9*this.y].possibleNumbers.indexOf(this.number))&&e[r+9*this.y].possibleNumbers.splice(t,1)}for(var b=0;b<9;b++){var t,l;i=e[t=b%3+9*Math.floor(b/3)+this.box%3*3+9*Math.floor(this.box/3)*3].number;if(-1==this.number){if(-1!=i)-1!=(l=this.possibleNumbers.indexOf(i))&&this.possibleNumbers.splice(l,1)}else if(-1==i)-1!=(l=e[t].possibleNumbers.indexOf(this.number))&&e[t].possibleNumbers.splice(l,1)}1==this.possibleNumbers.length&&(this.number=this.possibleNumbers.pop())}advancedLogic(e){var s=0;e[this.x+9*this.y].possibleNumbers.forEach((i=>{for(var r=0;r<9;r++){var b=r%3+9*Math.floor(r/3)+this.box%3*3+9*Math.floor(this.box/3)*3;if(e[b]!=e[this.x+9*this.y]){if(-1!=e[b].possibleNumbers.indexOf(i)){s=0;break}if(8!=++s)continue;this.number=i,this.possibleNumbers=[],this.basicLogic(e)}}}))}extraLogic(e){var s,i;switch(this.x%3){case 0:s=[0,1,2];break;case 1:s=[-1,0,1];break;case 2:s=[-2,-1,0]}switch(this.y%3){case 0:i=[0,1,2];break;case 1:i=[-1,0,1];break;case 2:i=[-2,-1,0]}for(var r=this.x+9*this.y,b=[...e[r].possibleNumbers],t=b.length,l=0;l<t;l++){for(var o=!1,n=!1,c=0;c<s.length;c++)if(-1==e[r+s[c]].number&&-1!=e[r+s[c]].possibleNumbers.indexOf(b[l])){o=!0;break}for(c=0;c<s.length;c++)if(o)for(var a=0;a<i.length;a++)if(0==i[a]);else if(-1!=e[r+s[c]+9*i[a]].possibleNumbers.indexOf(b[l])){o=!1;break}for(a=0;a<i.length;a++)if(-1==e[r+9*i[a]].number&&-1!=e[r+9*i[a]].possibleNumbers.indexOf(b[l])){n=!0;break}for(c=0;c<s.length;c++)if(n)for(a=0;a<i.length;a++)if(0==s[c]);else if(-1!=e[r+s[c]+9*i[a]].possibleNumbers.indexOf(b[l])){n=!1;break}if(o)for(var u=0;u<9;u++){if(-1==e[9*this.y+u].number&&e[9*this.y+u].box!=e[r].box)-1!=(m=e[9*this.y+u].possibleNumbers.indexOf(b[l]))&&(e[9*this.y+u].possibleNumbers.splice(m,1),1==e[9*this.y+u].possibleNumbers.length&&(e[9*this.y+u].number=e[9*this.y+u].possibleNumbers.pop(),e[9*this.y+u].basicLogic(e)))}if(n)for(var f=0;f<9;f++){var m;if(-1==e[this.x+9*f].number&&e[this.x+9*f].box!=e[r].box)-1!=(m=e[this.x+9*f].possibleNumbers.indexOf(b[l]))&&(e[this.x+9*f].possibleNumbers.splice(m,1),1==e[this.x+9*f].possibleNumbers.length&&(e[this.x+9*f].number=e[this.x+9*f].possibleNumbers.pop(),e[this.x+9*f].basicLogic(e)))}}}moreLogic(e){this.x,this.y;-1==this.number&&[...this.possibleNumbers].forEach((s=>{for(var i=!0,r=!0,b=0;b<9;b++){var t=9*this.y,l=e[t+b].number;if(e[t+b]!=this)if(-1==l){if(-1!=e[t+b].possibleNumbers.indexOf(s)){i=!1;break}}else if(-1!=e[t+b].possibleNumbers.indexOf(l)){i=!1;break}}if(!i)for(var o=0;o<9;o++){var n=this.x;l=e[n+9*o].number;if(e[n+9*o]!=this)if(-1==l){if(-1!=e[n+9*o].possibleNumbers.indexOf(s)){r=!1;break}}else if(-1!=e[n+9*o].possibleNumbers.indexOf(l)){r=!1;break}}(i||r)&&-1!=this.possibleNumbers.indexOf(s)&&(this.number=s,this.possibleNumbers=[],this.basicLogic(e))}))}sandwichLogic(e){}}var cells=[],cellsIndex=0,numbersBefore=0,numbersAfter=0,tries=0;function solve(){getNumbersFromUser(cells),cells.forEach((e=>{e.basicLogic(cells)})),displayNumbers(cells)}function solveAdvanced(){cells.forEach((e=>{-1==e.number&&e.advancedLogic(cells)})),displayNumbers(cells)}function solveExtra(){cells.forEach((e=>{-1==e.number&&e.extraLogic(cells)})),displayNumbers(cells)}function solveMore(){cells.forEach(((e,s)=>{-1==e.number&&e.moreLogic(cells)})),displayNumbers(cells)}function solveSandwich(){cells.forEach(((e,s)=>{-1==e.number&&e.sandwichLogic(cells)})),displayNumbers(cells)}function solveAuto(){var e=0;for(tries=0,numbersAfter=0,getNumbersFromUser(cells);tries<50;){switch(numbersBefore=numbersAfter,numbersAfter=0,tries++,e){case 0:cells.forEach((e=>{-1==e.number&&e.basicLogic(cells)}));break;case 1:cells.forEach((e=>{-1==e.number&&e.advancedLogic(cells)}));break;case 2:cells.forEach((e=>{-1==e.number&&e.extraLogic(cells)}));break;case 3:cells.forEach((e=>{-1==e.number&&e.moreLogic(cells)}))}if(getNumbersFromAuto(cells),e=numbersAfter>numbersBefore?0:0==e?1:1==e?2:2==e?3:0,81==numbersAfter)break}displayNumbers(cells),document.getElementById("finish").innerText=81==numbersAfter?"Success!":"Solver can't solve after 50 tries"}function getNumbersFromUser(e){e.forEach((e=>{var s=e.x+"."+e.y,i=document.getElementById(s),r=parseInt(i.innerText);r>0&&r<10&&(numbersAfter++,e.number=r,e.possibleNumbers=[])}))}function getNumbersFromAuto(e){e.forEach((e=>{-1!=e.number&&numbersAfter++}))}function displayNumbers(e){e.forEach((e=>{var s=e.x+"."+e.y;-1!=e.number&&(document.getElementById(s).innerText=e.number)}))}$(document).ready((function(){var e="#table_id",s=$('<thead id="thead"/>');$(e).append(s);var i=$('<tbody id="tbody"/>');$(e).append(i);for(var r=0;r<9;r++){for(var b=$('<tr contenteditable="true"/>'),t=0;t<9;t++)cells[cellsIndex++]=new Cell(t,r),b.append($("<td id="+t+"."+r+" data-x="+r+" data-y="+t+' style="width:50px;height:50px;text-align:center;border:1px solid black"/>'));$("#tbody").append(b)}}));
</script>

<table id="table_id" style="border-collapse:collapse">
</table>
<p id="finish"></p>
<input type="button" id="solve" value="Solve Automatically" onclick="solveAuto()" />
<br /><br />
